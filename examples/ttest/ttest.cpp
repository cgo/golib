#include <gomath.h>
#include <gottest.h>
#include <goplot.h>
#include <gofixedarray.h>

//=
//= Test data from the NIST/SEMATECH handbook,
//= http://www.itl.nist.gov/div898/handbook/eda/section3/eda3531.htm
const goSize_t am_size = 249;
const float american_cars[] = {
   18           ,
   15        ,
   18        ,
   16        ,
   17        ,
   15        ,
   14        ,
   14        ,
   14        ,
   15        ,
   15        ,
   14        ,
   15        ,
   14        ,
   22        ,
   18        ,
   21        ,
   21        ,
   10        ,
   10        ,
   11        ,
    9        ,
   28        ,
   25        ,
   19        ,
   16        ,
   17        ,
   19        ,
   18        ,
   14        ,
   14        ,
   14        ,
   14        ,
   12        ,
   13        ,
   13        ,
   18        ,
   22        ,
   19        ,
   18        ,
   23        ,
   26        ,
   25        ,
   20        ,
   21        ,
   13        ,
   14        ,
   15        ,
   14        ,
   17        ,
   11        ,
   13        ,
   12        ,
   13        ,
   15        ,
   13        ,
   13        ,
   14        ,
   22        ,
   28        ,
   13        ,
   14        ,
   13        ,
   14        ,
   15        ,
   12        ,
   13        ,
   13        ,
   14        ,
   13        ,
   12        ,
   13        ,
   18        ,
   16        ,
   18        ,
   18        ,
   23        ,
   11        ,
   12        ,
   13        ,
   12        ,
   18        ,
   21        ,
   19        ,
   21        ,
   15        ,
   16        ,
   15        ,
   11        ,
   20        ,
   21        ,
   19        ,
   15        ,
   26        ,
   25        ,
   16        ,
   16        ,
   18        ,
   16        ,
   13        ,
   14        ,
   14        ,
   14        ,
   28        ,
   19        ,
   18        ,
   15        ,
   15        ,
   16        ,
   15        ,
   16        ,
   14        ,
   17        ,
   16        ,
   15        ,
   18        ,
   21        ,
   20        ,
   13        ,
   23        ,
   20        ,
   23        ,
   18        ,
   19        ,
   25        ,
   26        ,
   18        ,
   16        ,
   16        ,
   15        ,
   22        ,
   22        ,
   24        ,
   23        ,
   29        ,
   25        ,
   20        ,
   18        ,
   19        ,
   18        ,
   27        ,
   13        ,
   17        ,
   13        ,
   13        ,
   13        ,
   30        ,
   26        ,
   18        ,
   17        ,
   16        ,
   15        ,
   18        ,
   21        ,
   19        ,
   19        ,
   16        ,
   16        ,
   16        ,
   16        ,
   25        ,
   26        ,
   31        ,
   34        ,
   36        ,
   20        ,
   19        ,
   20        ,
   19        ,
   21        ,
   20        ,
   25        ,
   21        ,
   19        ,
   21        ,
   21        ,
   19        ,
   18        ,
   19        ,
   18        ,
   18        ,
   18        ,
   30        ,
   31        ,
   23        ,
   24        ,
   22        ,
   20        ,
   22        ,
   20        ,
   21        ,
   17        ,
   18        ,
   17        ,
   18        ,
   17        ,
   16        ,
   19        ,
   19        ,
   36        ,
   27        ,
   23        ,
   24        ,
   34        ,
   35        ,
   28        ,
   29        ,
   27        ,
   34        ,
   32        ,
   28        ,
   26        ,
   24        ,
   19        ,
   28        ,
   24        ,
   27        ,
   27        ,
   26        ,
   24        ,
   30        ,
   39        ,
   35        ,
   34        ,
   30        ,
   22        ,
   27        ,
   20        ,
   18        ,
   28        ,
   27        ,
   34        ,
   31        ,
   29        ,
   27        ,
   24        ,
   23        ,
   38        ,
   36        ,
   25        ,
   38        ,
   26        ,
   22        ,
   36        ,
   27        ,
   27        ,
   32        ,
   28        ,
   31};
 
   const goSize_t jap_size = 79;
   const float japanese_cars[] = {
   24,
   27,
   27,
   25,
   31,
   35,
   24,
   19,
   28,
   23,
   27,
   20,
   22,
   18,
   20,
   31,
   32,
   31,
   32,
   24,
   26,
   29,
   24,
   24,
   33,
   33,
   32,
   28,
   19,
   32,
   34,
   26,
   30,
   22,
   22,
   33,
   39,
   36,
   28,
   27,
   21,
   24,
   30,
   34,
   32,
   38,
   37,
   30,
   31,
   37,
   32,
   47,
   41,
   45,
   34,
   33,
   24,
   32,
   39,
   35,
   32,
   37,
   38,
   34,
   34,
   32,
   33,
   32,
   25,
   24,
   37,
   31,
   36,
   36,
   34,
   38,
   32,
   38,
   32};

int main ()
{
    goVectorf Y1 (300);
    goFloat f = -10.0f;
    goFloat step = 20.0f / (float)Y1.getSize();
    for (goSize_t i = 0; i < Y1.getSize(); ++i, f = f + step)
        Y1[i] = f;

    goVectorf y (Y1.getSize());
    for (goSize_t i = 0; i < Y1.getSize(); ++i)
    {
        y[i] = goMath::studentT<goFloat> (Y1[i], 1);
    }

    goFixedArray<goFloat> am (const_cast<goFloat*>(american_cars), am_size, 1);
    goFixedArray<goFloat> ja (const_cast<goFloat*>(japanese_cars), jap_size, 1);

    bool result = goMath::tTest<goFloat, goFixedArray<goFloat> > (am, am_size, ja, jap_size, 0.05);
    if (result)
    {
        printf ("t-test accepts.\n");
    }
    else
    {
        printf ("t-test rejects.\n");
    }


    goMultiPlotter plotter(1,2);
    goSinglePlot plot;
    plot.addCurve (Y1, y, "");
    plot.setTitle ("Example t-distribution");
    plotter.addPlot (plot, 0, 0);

    plot.clear ();

    plot.addCurve (am, "American", "with points");
    plot.addCurve (ja, "Japanese", "with points");
    plot.setTitle ("Data");
    plotter.addPlot (plot, 0, 1);

    plotter.setPauseFlag (true);
    plotter.plot ();

    exit (1);
}
